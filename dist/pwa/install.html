<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®‰è£…æŒ‡å— - Tounet PWA</title>
    <link rel="manifest" href="manifest.json">
    <style>
    body {
      background-color: #f2f2f2;
      background-image: url("../assets/images/backgrounds/bg7.png");
      background-repeat: no-repeat;
      background-position: top;
      background-size: cover;
      background-attachment: fixed;
      margin: 0;
      padding: 20px;
      font-family: SEGA_Humming, Arial, sans-serif;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
    }

    .main-wrapper {
        width: 100%;
        max-width: 900px;
        margin: 80px auto 20px auto;
        opacity: 0.5;
    }

    .container {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 30px;
        margin-bottom: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        opacity: 0.85;
    }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #2f2f2f;
            margin-bottom: 10px;
        }
        
        .platform {
            margin-bottom: 30px;
            padding: 20px;
            border-left: 4px solid #2f2f2f;
            background: #f8f9ff;
            border-radius: 0 10px 10px 0;
        }
        
        .platform h3 {
            color: #2f2f2f;
            margin-top: 0;
        }
        
        .step {
            display: flex;
            align-items: flex-start;
            margin: 15px 0;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .step-number {
            background: #2f2f2f;
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }
        
        .screenshot {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 10px 0;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        .benefits {
            background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .benefits h3 {
            color: #2e7d32;
            margin-top: 0;
        }
        
        .benefit-item {
            display: flex;
            align-items: center;
            margin: 10px 0;
        }
        
        .benefit-item::before {
            content: "âœ…";
            margin-right: 10px;
        }
        
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.9);
            color: #2f2f2f;
            padding: 10px 15px;
            border-radius: 20px;
            text-decoration: none;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .install-btn {
            background: #2f2f2f;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            display: block;
            margin: 20px auto;
            transition: all 0.3s ease;
        }
        
        .install-btn:hover {
            background: #494949;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .note {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            .step {
                flex-direction: column;
                text-align: center;
            }
            
            .step-number {
                margin-bottom: 10px;
            }
        }
    </style>
</head>
<body>
    <a href="/" class="back-btn">â† è¿”å›ä¸»é¡µ</a>
    
    <div class="container">
        <div class="header">
            <h1>ğŸ“± å®‰è£… Tounet åº”ç”¨</h1>
            <p>å°† Tounet å®‰è£…åˆ°æ‚¨çš„è®¾å¤‡ï¼Œè·å¾—æ›´å¥½çš„ä½¿ç”¨ä½“éªŒ</p>
            <button class="install-btn" onclick="promptInstall()">ğŸš€ ç«‹å³å®‰è£…åº”ç”¨</button>
        </div>
        
        <div class="benefits">
            <h3>ğŸ¯ å®‰è£…åº”ç”¨çš„å¥½å¤„</h3>
            <div class="benefit-item">å¿«é€Ÿå¯åŠ¨ï¼Œæ— éœ€æ‰“å¼€æµè§ˆå™¨</div>
            <div class="benefit-item">ç¦»çº¿ä½¿ç”¨ï¼Œç½‘ç»œæ–­å¼€ä¹Ÿèƒ½è®¿é—®</div>
            <div class="benefit-item">èŠ‚çœæµé‡ï¼Œå†…å®¹æ™ºèƒ½ç¼“å­˜</div>
            <div class="benefit-item">æ¡Œé¢å›¾æ ‡ï¼Œä¸€é”®è®¿é—®</div>
            <div class="benefit-item">æ¨é€é€šçŸ¥ï¼Œä¸é”™è¿‡é‡è¦æ›´æ–°</div>
            <div class="benefit-item">å…¨å±ä½“éªŒï¼Œæ²‰æµ¸å¼ç•Œé¢</div>
        </div>
        
        <div class="platform">
            <h3>ğŸ–¥ï¸ æ¡Œé¢æµè§ˆå™¨ (Chrome/Edge/Firefox)</h3>
            <div class="step">
                <div class="step-number">1</div>
                <div>
                    <strong>å¯»æ‰¾å®‰è£…å›¾æ ‡</strong><br>
                    åœ¨åœ°å€æ å³ä¾§æŸ¥æ‰¾å®‰è£…å›¾æ ‡ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªä¸‹è½½æˆ–åŠ å·å›¾æ ‡ï¼‰
                </div>
            </div>
            <div class="step">
                <div class="step-number">2</div>
                <div>
                    <strong>ç‚¹å‡»å®‰è£…</strong><br>
                    ç‚¹å‡»å®‰è£…å›¾æ ‡ï¼Œç„¶ååœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ç¡®è®¤å®‰è£…
                </div>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <div>
                    <strong>å®Œæˆå®‰è£…</strong><br>
                    åº”ç”¨å°†è¢«å®‰è£…åˆ°æ‚¨çš„æ¡Œé¢æˆ–åº”ç”¨åˆ—è¡¨ä¸­
                </div>
            </div>
        </div>
        
        <div class="platform">
            <h3>ğŸ“± Android (Chrome)</h3>
            <div class="step">
                <div class="step-number">1</div>
                <div>
                    <strong>æ‰“å¼€èœå•</strong><br>
                    ç‚¹å‡»æµè§ˆå™¨å³ä¸Šè§’çš„ä¸‰ç‚¹èœå•æŒ‰é’®
                </div>
            </div>
            <div class="step">
                <div class="step-number">2</div>
                <div>
                    <strong>é€‰æ‹©å®‰è£…é€‰é¡¹</strong><br>
                    æ‰¾åˆ°å¹¶ç‚¹å‡»"å®‰è£…åº”ç”¨"æˆ–"æ·»åŠ åˆ°ä¸»å±å¹•"é€‰é¡¹
                </div>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <div>
                    <strong>ç¡®è®¤å®‰è£…</strong><br>
                    åœ¨å¼¹å‡ºçš„å¯¹è¯æ¡†ä¸­ç‚¹å‡»"å®‰è£…"æŒ‰é’®
                </div>
            </div>
        </div>
        
        <div class="platform">
            <h3>ğŸ iPhone/iPad (Safari)</h3>
            <div class="step">
                <div class="step-number">1</div>
                <div>
                    <strong>æ‰“å¼€åˆ†äº«èœå•</strong><br>
                    ç‚¹å‡»åº•éƒ¨å·¥å…·æ çš„åˆ†äº«æŒ‰é’®ï¼ˆæ–¹å½¢å¸¦ç®­å¤´çš„å›¾æ ‡ï¼‰
                </div>
            </div>
            <div class="step">
                <div class="step-number">2</div>
                <div>
                    <strong>æ·»åŠ åˆ°ä¸»å±å¹•</strong><br>
                    åœ¨åˆ†äº«é€‰é¡¹ä¸­æ‰¾åˆ°å¹¶ç‚¹å‡»"æ·»åŠ åˆ°ä¸»å±å¹•"
                </div>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <div>
                    <strong>è‡ªå®šä¹‰åç§°</strong><br>
                    å¯ä»¥ä¿®æ”¹åº”ç”¨åç§°ï¼Œç„¶åç‚¹å‡»"æ·»åŠ "å®Œæˆå®‰è£…
                </div>
            </div>
        </div>
        
        <div class="note">
            <strong>ğŸ’¡ æç¤ºï¼š</strong>
            å¦‚æœæ‚¨æ²¡æœ‰çœ‹åˆ°å®‰è£…é€‰é¡¹ï¼Œè¯·ç¡®ä¿æ‚¨ä½¿ç”¨çš„æ˜¯æ”¯æŒ PWA çš„ç°ä»£æµè§ˆå™¨ï¼Œå¹¶ä¸”ç½‘ç«™æ”¯æŒç¦»çº¿åŠŸèƒ½ã€‚
        </div>
        
        <div class="note">
            <strong>ğŸ”§ æ•…éšœæ’é™¤ï¼š</strong>
            å¦‚æœå®‰è£…å¤±è´¥ï¼Œè¯·å°è¯•åˆ·æ–°é¡µé¢æˆ–æ¸…é™¤æµè§ˆå™¨ç¼“å­˜åé‡è¯•ã€‚æŸäº›æµè§ˆå™¨å¯èƒ½éœ€è¦æ‚¨å…ˆä¸ç½‘ç«™è¿›è¡Œä¸€å®šç¨‹åº¦çš„äº¤äº’æ‰èƒ½æ˜¾ç¤ºå®‰è£…æç¤ºã€‚
        </div>
    </div>

    <script>
        let deferredPrompt;
        
        // ç›‘å¬å®‰è£…æç¤ºäº‹ä»¶
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('å®‰è£…æç¤ºå·²å‡†å¤‡');
        });
        
        // æ‰‹åŠ¨è§¦å‘å®‰è£…æç¤º
        async function promptInstall() {
            if (deferredPrompt) {
            deferredPrompt.prompt();
            const choiceResult = await deferredPrompt.userChoice;

            if (choiceResult.outcome === 'accepted') {
                showToast('ğŸ‰ æ„Ÿè°¢æ‚¨å®‰è£… Tounet åº”ç”¨ï¼');
            } else {
                showToast('ğŸ˜Š æ‚¨å¯ä»¥éšæ—¶é€šè¿‡æµè§ˆå™¨èœå•å®‰è£…åº”ç”¨');
            }

            deferredPrompt = null;
            } else {
            // å¦‚æœæ²¡æœ‰å®‰è£…æç¤ºï¼Œæ˜¾ç¤ºå¯ç‚¹å‡»çš„å‰å¾€/å–æ¶ˆèœå•
            showActionMenu({
                title: 'æœªæ£€æµ‹åˆ°å®‰è£…æç¤º',
                message: 'è¯·å‰å¾€Tounet Interfaceï¼Œæˆ–ç¨åå†è¯•ã€‚æŸäº›æµè§ˆå™¨éœ€è¦å…ˆä¸ç½‘ç«™äº¤äº’æ‰ä¼šæ˜¾ç¤ºå®‰è£…æç¤ºã€‚',
                url: 'https://map.riv62hjux.nyat.app:20898'
            });
            }
        }

        // åˆ›å»ºå¹¶æ˜¾ç¤ºâ€œå‰å¾€ / å–æ¶ˆâ€æ“ä½œèœå•
        function showActionMenu({ title = 'æç¤º', message = '', url = '#' } = {}) {
            // å¦‚æœå·²å­˜åœ¨èœå•åˆ™ä¸é‡å¤åˆ›å»º
            if (document.getElementById('tounet-action-menu')) return;

            const overlay = document.createElement('div');
            overlay.id = 'tounet-action-menu';
            Object.assign(overlay.style, {
            position: 'fixed',
            inset: '0',
            display: 'flex',
            'justify-content': 'center',
            'align-items': 'center',
            'background-color': 'rgba(0,0,0,0.4)',
            'z-index': '9999'
            });

            const panel = document.createElement('div');
            Object.assign(panel.style, {
            width: 'min(420px, 90%)',
            'background-color': '#fff',
            padding: '18px',
            'border-radius': '12px',
            'box-shadow': '0 8px 30px rgba(0,0,0,0.2)',
            'text-align': 'center',
            color: '#222'
            });

            const h = document.createElement('h3');
            h.textContent = title;
            Object.assign(h.style, { margin: '0 0 8px 0', color: '#2f2f2f' });

            const p = document.createElement('p');
            p.textContent = message;
            Object.assign(p.style, { margin: '0 0 16px 0', 'line-height': '1.4' });

            const btnRow = document.createElement('div');
            Object.assign(btnRow.style, { display: 'flex', gap: '10px', 'justify-content': 'center' });

            const goBtn = document.createElement('button');
            goBtn.textContent = 'å‰å¾€';
            Object.assign(goBtn.style, {
            background: '#2f2f2f',
            color: '#fff',
            border: 'none',
            padding: '10px 18px',
            'border-radius': '8px',
            cursor: 'pointer'
            });
            goBtn.onclick = () => {
            // æ‰“å¼€æ‰‹åŠ¨å®‰è£…é¡µï¼ˆæ–°æ ‡ç­¾ï¼‰
            window.open(url, '_blank', 'noopener');
            removeActionMenu();
            };

            const cancelBtn = document.createElement('button');
            cancelBtn.textContent = 'å–æ¶ˆ';
            Object.assign(cancelBtn.style, {
            background: '#f1f1f1',
            color: '#333',
            border: 'none',
            padding: '10px 18px',
            'border-radius': '8px',
            cursor: 'pointer'
            });
            cancelBtn.onclick = () => {
            showToast('æ“ä½œå·²å–æ¶ˆ');
            removeActionMenu();
            };

            // ç‚¹å‡»è¦†ç›–å±‚ç©ºç™½å¤„ä¹Ÿå…³é—­
            overlay.addEventListener('click', (ev) => {
            if (ev.target === overlay) {
                removeActionMenu();
            }
            });

            btnRow.appendChild(goBtn);
            btnRow.appendChild(cancelBtn);
            panel.appendChild(h);
            panel.appendChild(p);
            panel.appendChild(btnRow);
            overlay.appendChild(panel);
            document.body.appendChild(overlay);

            // å–æ¶ˆå¹¶ç§»é™¤èœå•
            function removeActionMenu() {
            overlay.remove();
            }
        }

        // ç®€å•çš„æç¤ºï¼ˆçŸ­æš‚çš„ toastï¼‰
        function showToast(text, duration = 2500) {
            const id = 'tounet-toast';
            let t = document.getElementById(id);
            if (t) {
            t.remove();
            }
            t = document.createElement('div');
            t.id = id;
            t.textContent = text;
            Object.assign(t.style, {
            position: 'fixed',
            bottom: '22px',
            left: '50%',
            transform: 'translateX(-50%)',
            background: 'rgba(0,0,0,0.75)',
            color: '#fff',
            padding: '10px 14px',
            'border-radius': '20px',
            'z-index': '10000',
            'font-size': '14px'
            });
            document.body.appendChild(t);
            setTimeout(() => t.remove(), duration);
        }

        // æ£€æµ‹æ˜¯å¦å·²å®‰è£…
        if (window.matchMedia && window.matchMedia('(display-mode: standalone)').matches) {
            // åº”ç”¨å·²å®‰è£…ä¸”ä»¥ç‹¬ç«‹æ¨¡å¼è¿è¡Œ
            const installBtn = document.querySelector('.install-btn');
            if (installBtn) {
            installBtn.textContent = 'âœ… åº”ç”¨å·²å®‰è£…';
            installBtn.disabled = true;
            installBtn.style.background = '#4CAF50';
            installBtn.style.cursor = 'default';
            }
        }
        
        // ç›‘å¬åº”ç”¨å®‰è£…äº‹ä»¶
        window.addEventListener('appinstalled', () => {
            alert('ğŸ‰ Tounet åº”ç”¨å®‰è£…æˆåŠŸï¼æ‚¨ç°åœ¨å¯ä»¥åœ¨æ¡Œé¢æˆ–åº”ç”¨åˆ—è¡¨ä¸­æ‰¾åˆ°å®ƒã€‚');
        });
    </script>
</body>
</html>
